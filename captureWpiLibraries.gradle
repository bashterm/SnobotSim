
task captureWpiLibraries(type: Jar, dependsOn: extractWpilibjZip) {

    def os_name = org.gradle.internal.os.OperatingSystem.current().getFamilyName();
    def output_path = os_name + "/x86-64/"
    
    destinationDir = file("$rootDir/build/wpi_libraries")
    classifier = "wpi_native-" + os_name;
    
    from("$rootDir/build/dependencies/wpilibj-jni")
    
    def wpiutil_path = "$rootDir/build/dependencies/wpiutil-cpp/" + os_name + "x86-64/" + os_name + "/x86-64/shared"
    from(wpiutil_path) {
        into output_path
        include "*.dll"
        include "*.so"
    }
    
    def hal_path = "$rootDir/build/dependencies/hal/libs/" + os_name + '/x86-64/shared'
    from(hal_path) {
        into output_path
        include "*.dll"
        include "*.so"
    }
    
    def hal_adx_sim_path = "$rootDir/build/dependencies/halsim-adx_gyro_accelerometer/libs/" + os_name + '/x86-64/shared'
    from(hal_adx_sim_path) {
        into output_path
        include "*.dll"
        include "*.so"
    }
}
